(function(){"use strict";var t={6306:function(t,e,o){var r=o(5130),s=o(6768),n=o(4232);const a={id:"app",class:"container"},c={class:"navbar navbar-expand-lg navbar-light bg-light shadow p-3 mb-3 row"},i={class:"collapse navbar-collapse col-md-6"},u=["textContent"],l={class:"m-3 col-md-6"},d=["disabled"],h=(0,s.Lk)("br",null,null,-1),m={key:0},p={key:1};function v(t,e,o,r,v,f){const C=(0,s.g2)("course-list"),b=(0,s.g2)("checkout");return(0,s.uX)(),(0,s.CE)("div",a,[(0,s.Lk)("nav",c,[(0,s.Lk)("div",i,[(0,s.Lk)("h1",{textContent:(0,n.v_)(v.sitename),class:"mt-5"},null,8,u)]),(0,s.Lk)("div",l,[(0,s.Lk)("button",{disabled:0==v.cart.length,onClick:e[0]||(e[0]=(...t)=>f.showCheckout&&f.showCheckout(...t)),class:"btn btn-outline-success btn-lg float-end m-4 p-2"}," Checkout "+(0,n.v_)(f.cartItemCount),9,d),h])]),(0,s.Lk)("main",null,[v.showCourse?((0,s.uX)(),(0,s.CE)("div",m,[(0,s.bF)(C,{is:v.currentComponent,onAddcourse:f.addToCart,onCanCart:f.canAddToCart,onCartcounter:f.cartCount},null,8,["is","onAddcourse","onCanCart","onCartcounter"])])):((0,s.uX)(),(0,s.CE)("div",p,[(0,s.bF)(b,{cart:v.cart,courses:v.courses,onCartCount:f.cartCount,onRemoveItem:f.removeFromCart,onSubmitForm:f.submitForm},null,8,["cart","courses","onCartCount","onRemoveItem","onSubmitForm"])]))])])}o(4114);const f={class:"row"},C={class:"col-md-4"},b={class:"col-md-4"},k=(0,s.Lk)("option",{value:"title"},"Title",-1),y=(0,s.Lk)("option",{value:"location"},"Location",-1),L=(0,s.Lk)("option",{value:"price"},"Price",-1),w=[k,y,L],g={class:"col-md-4"},O=(0,s.Lk)("option",{value:"asc"},"Ascending",-1),N=(0,s.Lk)("option",{value:"desc"},"Descending",-1),x=[O,N],I={class:"row m-4"},E={class:"card m-3 shadow"},A=["src"],F={class:"card-body"},T=["textContent"],_=["innerHTML"],j={class:"card-text"},X={class:"card-text"},P=["onClick"],S={key:1,disabled:"disabled"},Q={key:2},$={key:3},J={key:4};function U(t,e,o,a,c,i){return(0,s.uX)(),(0,s.CE)("div",f,[(0,s.Lk)("div",C,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>c.searchQuery=t),class:"form-control",style:{width:"350px"},type:"text",placeholder:"Search for courses"},null,512),[[r.Jo,c.searchQuery]])]),(0,s.Lk)("div",b,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>c.sortOption=t),class:"form-control",style:{width:"350px"}},w,512),[[r.u1,c.sortOption]])]),(0,s.Lk)("div",g,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>c.sortOrder=t),class:"form-control",style:{width:"350px"}},x,512),[[r.u1,c.sortOrder]])]),(0,s.Lk)("div",I,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.sortedCourses,(t=>((0,s.uX)(),(0,s.CE)("div",{class:"col-md-4",key:t.id},[(0,s.Lk)("div",E,[(0,s.Lk)("img",{src:"https://cw-2-smoky.vercel.app/"+t.image,class:"ct height: 250px; width: 100%; mx-auto d-block card-img-top"},null,8,A),(0,s.Lk)("div",F,[(0,s.Lk)("h2",{textContent:(0,n.v_)(t.title),class:"card-title"},null,8,T),(0,s.Lk)("p",{innerHTML:t.description,class:"card-text"},null,8,_),(0,s.Lk)("p",j,"Location: "+(0,n.v_)(t.location),1),(0,s.Lk)("p",X,"Price: "+(0,n.v_)(t.price),1),(0,s.Lk)("p",null," Available stock: "+(0,n.v_)(t.availableInventory-i.cartCount(t.id)),1),i.canAddToCart(t)?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:e=>i.addItem(t),class:"btn btn-outline-info"}," Add to cart ",8,P)):((0,s.uX)(),(0,s.CE)("button",S,"Add to cart")),t.availableInventory===i.cartCount(t.id)?((0,s.uX)(),(0,s.CE)("span",Q," All out! ")):t.availableInventory-i.cartCount(t.id)<5?((0,s.uX)(),(0,s.CE)("span",$," Only "+(0,n.v_)(t.availableInventory-i.cartCount(t.id))+" left! ",1)):((0,s.uX)(),(0,s.CE)("span",J,"Buy now!"))])])])))),128))])])}var V={name:"courseList",props:["addcourse","canCart"],data(){return{sitename:"Welcome to After School!",courses:[],searchQuery:"",cart:[],sortOption:"title",sortOrder:"asc"}},created(){this.getCourses()},methods:{async getCourses(){var t="https://cw-2-smoky.vercel.app/collection/courses/",e=await fetch(t);e=await e.json(),this.courses=e,console.log("Courses fetched")},addItem(t){this.$emit("addcourse",t)},canAddToCart(t){return t.availableInventory>this.cartCount(t.id)},cartCount(t){return this.cart.filter((e=>e===t)).length}},computed:{sortedCourses(){var t=[...this.courses],e="asc"===this.sortOrder?1:-1;if(this.searchQuery){var o=this.searchQuery.toLowerCase();t=t.filter((t=>t.title.toLowerCase().includes(o)||t.location.toLowerCase().includes(o)))}return t.sort(((t,o)=>t[this.sortOption]>o[this.sortOption]?1*e:t[this.sortOption]<o[this.sortOption]?-1*e:0))}}},W=o(1241);const M=(0,W.A)(V,[["render",U]]);var R=M;const z=(0,s.Lk)("h2",null,"Shopping cart",-1),H={class:"row"},K=["src"],Z={class:"card-body"},B={class:"card-title"},D={class:"card-text"},q={class:"card-text"},G={class:"card-text"},Y=["onClick"],tt=(0,s.Lk)("h2",null,"Checkout",-1),et=(0,s.Lk)("strong",null,"First Name:",-1),ot=(0,s.Lk)("strong",null,"Phone Number:",-1),rt=(0,s.Lk)("h2",null,"Order Information",-1),st=["disabled"];function nt(t,e,o,a,c,i){return(0,s.uX)(),(0,s.CE)("div",null,[z,(0,s.Lk)("ul",H,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.cartCourses,(t=>((0,s.uX)(),(0,s.CE)("li",{key:t.course.id,class:"card col-md-3 m-2 shadow"},[(0,s.Lk)("img",{src:t.course.image,class:"ct height: 200px; width: 100%; mx-auto d-block card-img-top"},null,8,K),(0,s.Lk)("div",Z,[(0,s.Lk)("h2",B,(0,n.v_)(t.course.title),1),(0,s.Lk)("p",D,"Location: "+(0,n.v_)(t.course.location),1),(0,s.Lk)("p",q,"Price: "+(0,n.v_)(t.course.price),1),(0,s.Lk)("p",G,"Quantity: "+(0,n.v_)(t.count),1),(0,s.Lk)("button",{onClick:e=>i.removeItem(t.course.id),class:"btn btn-outline-danger"}," Remove ",8,Y)])])))),128))]),tt,(0,s.Lk)("p",null,[et,(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>c.order.firstName=t),id:"firstName",type:"text",class:"form-control-sm m-2",pattern:"^[a-zA-Z\\s]+$"},null,512),[[r.Jo,c.order.firstName,void 0,{trim:!0}]])]),(0,s.Lk)("p",null,[ot,(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>c.order.phoneNumber=t),id:"phoneNumber",type:"number",class:"form-control-sm m-2"},null,512),[[r.Jo,c.order.phoneNumber,void 0,{number:!0}]])]),rt,(0,s.Lk)("p",null,"First Name: "+(0,n.v_)(c.order.firstName),1),(0,s.Lk)("p",null,"phone Number: "+(0,n.v_)(c.order.phoneNumber),1),(0,s.Lk)("button",{type:"submit",disabled:!i.validInput,onClick:e[2]||(e[2]=(...t)=>i.submitForm&&i.submitForm(...t)),class:"mb-4 btn"}," Place Order ",8,st)])}var at={name:"Form-Component",props:["cart","courses"],data(){return{order:{firstName:"",phoneNumber:""}}},methods:{removeItem(t){this.$emit("remove-item",t)},submitForm(){this.$emit("submit-form",{Name:this.order.firstName,PhoneNumber:this.order.phoneNumber}),console.log("Form submitted with:",this.name,this.address),this.name="",this.address=""},async checkout(){var t={courses:[...this.cart],firstName:this.order.firstName,phoneNumber:this.order.phoneNumber};this.cart.forEach((t=>{t=this.courses.filter((e=>e.id==t))[0],t.availableInventory-=this.cartCount(t.id),fetch(`https://cw-2-smoky.vercel.app/collection/courses/${t._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({availableInventory:t.availableInventory})})})),await fetch("https://cw-2-smoky.vercel.app/collection/orders/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),alert("order successful"),this.showCourse=!0}},computed:{cartCourses(){const t={};return this.cart.forEach((e=>{if(t[e])t[e].count++;else{const o=this.courses.filter((t=>t.id===e))[0];o&&(t[e]={course:o,count:1})}})),Object.values(t)},validInput(){return/^[a-zA-Z\s]+$/.test(this.order.firstName)&&/^\d+$/.test(this.order.phoneNumber)}}};const ct=(0,W.A)(at,[["render",nt]]);var it=ct,ut={name:"app",data(){return{currentComponent:"courseList",sitename:"Welcome to After School!",courses:[],searchQuery:"",cart:[],showCourse:!0,sortOption:"title",sortOrder:"asc",order:{firstName:"",phoneNumber:""}}},components:{courseList:R,checkout:it},created(){"serviceWorker"in navigator&&navigator.serviceWorker.register("service-worker.js"),this.getCourses()},methods:{toggleComponent(){this.currentComponent="courseList"===this.currectComponent?"checkout":"courseList"},async getCourses(){var t="https://cw-2-smoky.vercel.app/collection/courses/",e=await fetch(t);e=await e.json(),this.courses=e,console.log("fetched")},async searchCourses(){var t={search:this.searchQuery,sort:this.sortOption,order:this.sortOrder},e=await fetch("https://cw-2-smoky.vercel.app/collection/courses/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});e=await e.json(),this.courses=e,console.log("fetched")},addToCart(t){this.cart.push(t.id),t.availableInventory--},removeFromCart(t){const e=this.cart.indexOf(t);-1!==e&&this.cart.splice(e,1)},showCheckout(){this.showCourse=!this.showCourse},submitForm(){alert("Order submitted!")},canAddToCart(t){return t.availableInventory>this.cartCount(t.id)},cartCount(t){let e=0;for(let o=0;o<this.cart.length;o++)this.cart[o]===t&&e++;return e}},computed:{cartItemCount(){return this.cart.length},cartCourses(){const t={};return this.cart.forEach((e=>{if(t[e])t[e].count++;else{const o=this.courses.find((t=>t.id===e));o&&(t[e]={course:o,count:1})}})),Object.values(t)},sortedCourses(){var t=this.courses,e="asc"===this.sortOrder?1:-1;if(this.searchQuery){var o=this.searchQuery.toLowerCase();t=t.filter((t=>t.title.toLowerCase().includes(o)||t.location.toLowerCase().includes(o)))}return t.sort(((t,o)=>t[this.sortOption]>o[this.sortOption]?1*e:t[this.sortOption]<o[this.sortOption]?-1*e:0))}}};const lt=(0,W.A)(ut,[["render",v]]);var dt=lt;(0,r.Ef)(dt).mount("#app")}},e={};function o(r){var s=e[r];if(void 0!==s)return s.exports;var n=e[r]={exports:{}};return t[r].call(n.exports,n,n.exports,o),n.exports}o.m=t,function(){var t=[];o.O=function(e,r,s,n){if(!r){var a=1/0;for(l=0;l<t.length;l++){r=t[l][0],s=t[l][1],n=t[l][2];for(var c=!0,i=0;i<r.length;i++)(!1&n||a>=n)&&Object.keys(o.O).every((function(t){return o.O[t](r[i])}))?r.splice(i--,1):(c=!1,n<a&&(a=n));if(c){t.splice(l--,1);var u=s();void 0!==u&&(e=u)}}return e}n=n||0;for(var l=t.length;l>0&&t[l-1][2]>n;l--)t[l]=t[l-1];t[l]=[r,s,n]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};o.O.j=function(e){return 0===t[e]};var e=function(e,r){var s,n,a=r[0],c=r[1],i=r[2],u=0;if(a.some((function(e){return 0!==t[e]}))){for(s in c)o.o(c,s)&&(o.m[s]=c[s]);if(i)var l=i(o)}for(e&&e(r);u<a.length;u++)n=a[u],o.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return o.O(l)},r=self["webpackChunkcw3"]=self["webpackChunkcw3"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=o.O(void 0,[504],(function(){return o(6306)}));r=o.O(r)})();
//# sourceMappingURL=app.d7d542f5.js.map